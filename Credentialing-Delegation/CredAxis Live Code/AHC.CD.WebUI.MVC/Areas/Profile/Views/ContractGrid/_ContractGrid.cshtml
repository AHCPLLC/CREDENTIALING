@{
    ViewBag.Title = "Contract Grid";
}
@using Microsoft.AspNet.Identity;
@using Microsoft.AspNet.Identity.Owin;
<style>
    .select-page {
        width: 50px;
        text-align: center;
    }

    .loadingHistory {
        padding-left: 7px;
    }

    .pagination li a input {
        padding: 0;
        margin: -5px 0;
    }
</style>
<div class="panel-group col-lg-12 " ng-controller="ContractGridController as mc" ng-cloak>
    <div>
        <br />
    </div>
    <div id="Added_Contracts_FiledSet">
        <ul class="nav nav-tabs" role="tablist">
            <li class="active"><a id="tabs1" data-toggle="tab" ng-click="activeContractData()" href="#tab1">Active Contracts</a></li>
            <li><a id="tabs3" data-toggle="tab" ng-click="inactiveContractData()" href="#tab1">Inactive Contracts</a></li>

        </ul>
        <div class="tab-content">
            <div id="tab1" class="tab-pane fade in active">

            </div>
            <fieldset>
                <legend>Contract Grid</legend>
                <div class="btn-group pull-right legend2 ng-scope">
                    <button ng-if="isEdit" ng-click="cancelEdit()" class="btn btn-xs btn-default" tooltip data-toggle="tooltip" data-placement="top" title="" style="border-radius:2px;"><i class="fa fa-close"></i></button>
                    <button ng-if="isView" ng-click="cancelView()" class="btn btn-xs btn-default" tooltip data-toggle="tooltip" data-placement="top" title="" style="border-radius:2px;"><i class="fa fa-close"></i></button>
                    <button class="dropdown-toggle btn btn-xs btn-primary" tooltip data-toggle="tooltip" data-placement="top" title="print" ng-if="printData"><span ng-click="printCGData()" data-content=" print" data-original-title="" title="" class="fa fa-print"></span></button>
                    <button type="button" class="btn btn-xs btn-primary" tooltip data-toggle="tooltip" data-placement="top" title="Export to excel" ng-if="printData" ng-click="exportToExcel1()" style="margin-left:5px;border-radius:2px;"><i class="fa fa-file-excel-o"></i></button>
                    @*@if (HttpContext.Current.User.Identity.IsAuthenticated)
                        {
                            var roles = Context.GetOwinContext().GetUserManager<AHC.CD.WebUI.MVC.ApplicationUserManager>().GetRoles(User.Identity.GetUserId());
                            if (roles.Contains("CRA"))
                            {
                                <span><button style="margin-left:5px" class="btn btn-xs btn-success" tooltip data-toggle="tooltip" data-placement="bottom" title="Add New" ng-click="FlipingTabs('Add_New_Contract','Added_Contracts_FiledSet');changeTabs('GenInfoTab', 'id01', 'GenInfo');"><i class="fa fa-plus"></i></button></span>
                            }
                        }*@
                    <div ng-show="LoadForPdf" class=" pull-right "><img src="/Content/Images/ajax-loader.gif" width="20" height="20"></div>
                </div>
                <div class="col-lg-12 zero-padding-left-right-div">
                    <div ng-show="activeMessageDiv=='successfullySaved'" class="alert alert-success" role="alert">
                        <button ng-click="closeAlertMessage('')" class="close"><span>&times;</span></button>
                        {{messageDesc}}
                    </div>
                    <div ng-show="activeMessageDiv=='errorInitiated'" class="col-lg-12">
                        <div class="alert alert-danger" role="alert">
                            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <span class="sr-only">Error:</span>
                            <span>{{messageDesc}}</span>
                        </div>
                    </div>
                </div>
                <div ng-show="AjaxLoading" class="progress col-lg-12">
                    <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                        Loading...Please wait...
                    </div>
                </div>
                @*<button type="button" ng-disabled="1==1" class="btn btn-xs btn-primary pull-right" style="margin-left:3px;" tooltip="" data-toggle="tooltip" data-placement="top" title="" data-original-title="View InActive Contracts">InActive Contracts</button>*@
                @*<div ng-if="!isView || !isEdit">*@
                <div ng-if="tableView">
                    <div class="col-lg-12 form-group  zero-padding-left-right-div">
                        <table class='table table-bordered table-condensed customtbodyStyle table-striped' st-pipe="mc.callServer" st-table="mc.displayed" st-safe-src="activeContractStatus?activeContracts:inactiveContracts" id=" contract_grid">
                            <thead>
                                <tr>
                                    <th st-sort-default="reverse" st-sort="PlanName" class="col-lg-2">PLAN</th>
                                    <th st-sort="LOBCode" class="col-lg-1">LOB</th>
                                    <th st-sort="ParticiPationStatus" class="col-lg-1">PARTICIPATING STATUS</th>
                                    <th st-sort="GroupID" class="col-lg-1">GROUP ID</th>
                                    <th st-sort="IndividualID" class="col-lg-1">PROVIDER ID</th>
                                    <th st-sort="EffectiveDate" class="col-lg-1">EFFECTIVE DATE</th>
                                    <th st-sort="TerminationDate" class="col-lg-1">TERMINATION DATE</th>
                                    <th st-sort="PracticeLocation" class="col-lg-2">PRACTICE LOCATION</th>
                                    <th class="col-lg-1">ACTION</th>
                                </tr>
                                <tr id="hideForPdf1">
                                    <td class="hideData "><input id="Plan_CG" st-search="PlanName" type="text" placeholder="Filter Insurance" class="form-control input-sm" /></td>
                                    <td class="hideData"><input id="LOB_CG" st-search="LOBCode" type="text" placeholder="Filter LOB" class="form-control input-sm" /></td>
                                    <td class="hideData"><input id="Status_CG" st-search="ParticiPationStatus" type="text" placeholder="Filter Participating Status" class="form-control input-sm" /></td>
                                    <td class="hideData"><input id="Group_CG" st-search="GroupID" type="text" placeholder="Filter Group ID" class="form-control input-sm" /></td>
                                    <td class="hideData"><input id="ProviderId_CG" st-search="IndividualID" type="text" placeholder="Filter Provider ID" class="form-control input-sm" /></td>
                                    <td class="hideData "><input id="EffectiveDate_CG" st-search="EffectiveDate" type="text" placeholder="Filter Effective Date" class="form-control input-sm" /></td>
                                    <td class="hideData "><input id="TerminationDate_CG" st-search="TerminationDate" type="text" placeholder="Filter Termination Date" class="form-control input-sm" /></td>
                                    <td class="hideData "><input id="PracticeLocation" st-search="PracticeLocation" type="text" placeholder="Filter Practice Location" class="form-control input-sm" /></td>
                                    <td></td>
                                </tr>
                            </thead>

                            <tbody ng-show="!mc.isLoading">
                                <tr ng-repeat="c in mc.displayed">

                                    <td>{{c.PlanName || 'Not Available'}}</td>
                                    <td><span><span ng-if="$index>0"></span><span class="label label-primary">{{c.LOBCode || 'NotAvailable'}}</span></span></td>
                                    <td>{{c.ParticiPationStatus|| 'Not Available'}}</td>
                                    <td>{{c.GroupID|| 'Not Available'}}</td>
                                    <td>{{c.IndividualID|| 'Not Available'}}</td>
                                    <td>{{c.EffectiveDate || 'Not Available'}}</td>
                                    <td>{{c.TerminationDate || 'Not Available'}}</td>
                                    @*<td>{{c.PracticeLocationCorporateName ||'Not Available'}}</td>*@
                                    @*<td st-ratio="10" class="wrap-words">{{c.FacilityName}}-{{c.FacilityStreet}},{{c.FacilityCity}},{{c.FacilityState}},{{c.FacilityCountry}}</td>*@
                                    <td>{{c.PracticeLocation || 'Not Available'}}</td>

                                    <td>
                                        <button class="btn btn-xs btn-default" ng-click="viewContractGrid(c.ContractGridID,c.PlanName,c.LOBName)" tooltip data-toggle="tooltip" data-placement="left" title="View"><i class="fa fa-eye"></i></button>
                                        @if (HttpContext.Current.User.Identity.IsAuthenticated)
                                        {
                                            var roles = Context.GetOwinContext().GetUserManager<AHC.CD.WebUI.MVC.ApplicationUserManager>().GetRoles(User.Identity.GetUserId());
                                            if (roles != null)
                                            {
                                                if (roles.Contains("CCO") || roles.Contains("CRA"))
                                                {
                                                    <button id="New_Eidt_ContractGrid" class="btn btn-xs btn-primary" ng-if="activeContractStatus" ng-click="EditContractGrid(c.ContractGridID,c.PlanName,c.LOBName)" tooltip data-toggle="tooltip" data-placement="top" title="Edit"><i class="fa fa-edit"></i></button>
                                                    <button class="btn btn-xs btn-primary" ng-if="!activeContractStatus" ng-click="reactivateContractGrid(c.ContractGridID)" tooltip data-toggle="tooltip" data-placement="top" title="Reactivate"><i class="fa fa-repeat"></i></button>
                                                    <button class="btn btn-xs btn-danger" ng-if="activeContractStatus" ng-click="initWarning(c.ContractGridID)" tooltip data-toggle="tooltip" data-placement="left" title="Remove"><i class="fa fa-remove"></i></button>
                                                }
                                            }
                                        }
                                        @*<button class="btn btn-xs btn-danger" ng-if="activeContractStatus" ng-click="initWarning(c.ContractGridID)" tooltip data-toggle="tooltip" data-placement="left" title="Remove"><i class="fa fa-remove"></i></button>*@
                                            @*<button class="btn btn-xs btn-primary" ng-if="!activeContractStatus" ng-click="reactivateContractGrid(c.ContractGridID)" tooltip data-toggle="tooltip" data-placement="top" title="Reactivate"><i class="fa fa-repeat"></i></button>*@
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="9">
                                            <div ng-show="mc.displayed.length==0 && !mc.isLoading " class="text-center">
                                                <label>No Data Available.</label>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                                <tbody ng-show="mc.isLoading">
                                    <tr>
                                        <td colspan="9" class="text-center">
                                            <div class="loading-indicator"></div>
                                        </td>
                                    </tr>
                                </tbody>
                                <tfoot id="hideForPdf2" style="cursor:pointer">
                                    <tr>
                                        <td class="text-center" st-pagination="" st-items-by-page="10" colspan="9"></td>
                                    </tr>
                                </tfoot>
                            </table>
                            <table style="display:none" ng-if="AllData" class="table table-bordered table-condensed customtbodyStyle table-striped" id="Contract_Grid1">
                                <thead>
                                    <tr>
                                        <th>Plan</th>
                                        <th>LOB</th>
                                        <th ng-if="ProfilePanelData">Panel Status</th>
                                        <th>Participating Status</th>
                                        <th>Group ID</th>
                                        <th>Individual ID</th>
                                        <th>Effective Date</th>
                                        <th>Termination Date</th>
                                            <th>Practice Location</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    <tr ng-repeat="c in filtered">

                                        <td>{{c.PlanName || 'Not Available'}}</td>
                                        <td><span><span ng-if="$index>0"></span><span class="label label-primary">{{c.LOBCode || NotAvailable}}</span></span></td>
                                        <td ng-if="ProfilePanelData">{{c.PanelStatus || 'Not Available'}}</td>
                                        <td>{{c.ParticiPationStatus|| 'Not Available'}}</td>
                                        <td>{{c.GroupID|| 'Not Available'}}</td>
                                        <td>{{c.IndividualID|| 'Not Available'}}</td>
                                        <td>{{c.EffectiveDate || 'Not Available'}}</td>
                                        @*<td>{{c.TerminationDate || 'Not Available'}}</td>
                                            <td>{{c.PracticeLocationCorporateName ||'Not Available'}}</td>*@
                                        <td>{{c.TerminationDate || 'Not Available'}}</td>
                                        @*<td>{{c.PracticeLocationCorporateName ||'Not Available'}}</td>*@
                                        @*<td st-ratio="10" class="wrap-words">{{c.FacilityName}}-{{c.FacilityStreet}},{{c.FacilityCity}},{{c.FacilityState}},{{c.FacilityCountry}}</td>*@
                                        <td>{{c.PracticeLocation || 'Not Available'}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <br />
                        @*<div ng-show="mc.displayed.length==0 && !mc.isLoading " class="text-center">
                                <label>No Data Available.</label>
                            </div>*@
                        <br />
                        <div class="col-lg-12">
                            <div ng-show="!mc.displayed.length==0 && !mc.isLoading">
                                <span class="label label-primary">C- COMMERCIAL</span>&nbsp;
                                <span class="label label-primary">CE- COMMERCIAL EXCHANGE</span>&nbsp;
                                <span class="label label-primary">FFS- FEE FOR SERVICE</span>&nbsp;
                                <span class="label label-primary">MCR- MEDICARE</span>&nbsp;
                                <span class="label label-primary">MCD- MEDICAID</span>&nbsp;
                                <span class="label label-primary">MR- MEDICARE RISK</span>&nbsp;
                                <span class="label label-primary">WC- WORKERS COMPENSATION</span>&nbsp;
                                <span class="label label-primary">GOV- GOVERNMENT</span>&nbsp;
                                <span class="label label-primary">IME- INDEPENDENT MEDICAL EVALUATION</span>&nbsp;
                                <span class="label label-primary">US DOL- US DEPARTMENT OF LABOR</span>&nbsp;
                                <span class="label label-primary">EAP- EMPLOYEE ASSISTANCE PROGRAM</span>&nbsp;
                            </div>
                        </div>
                    </div>
                    <div class=" zero-padding-left-right-div" ng-if="isView">
                        @Html.Partial("~/Areas/Credentialing/Views/CnD/_ViewContractGrid.cshtml")
                    </div>
                    <div class=" zero-padding-left-right-div" ng-if="isEdit">
                        @Html.Partial("~/Areas/Credentialing/Views/CnD/_EditContractGrid.cshtml")
                        <br />
                    </div>
                </fieldset>
            </div>
        </div>
        @*<div id="Add_New_Contract" class="row">
                @Html.Partial("~/Areas/Profile/Views/ContractGrid/_AddNewContractFromProfile.cshtml")
            </div>*@
        <div class="modal fade" id="WarningModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form id="removeStateLicense">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Warning!!!!</h4>
                        </div>
                        <div class="modal-body">
                            Do you really want to remove this record from list ?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" ng-click="RemoveReport()">Remove</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal fade" id="WarningModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form id="removeStateLicense">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Warning!!!!</h4>
                        </div>
                        <div class="modal-body">
                            Do you really want to reactivate this record ?

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" ng-click="ReactivateInactiveReport()">Reactivate</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="hiddenPrintDiv1" style="display:none;">


    </div>
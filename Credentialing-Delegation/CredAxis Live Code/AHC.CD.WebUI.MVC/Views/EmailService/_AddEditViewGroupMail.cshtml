@model AHC.CD.WebUI.MVC.Models.EmailService.EmailGroupViewModel

<style>
    b {
        font-size: large;
    }

    textarea.large-compact {
        height: 2.5em;
        transition: height .3s ease-out;
        width: 85%;
    }

        textarea.large-compact:focus {
            height: 5em;
        }

    /*#GroupName{
            width:85%
        }*/
    .biscuits_3D > .row > .col-lg-12 > .panel-body {
        color: whitesmoke;
        position: relative;
        text-decoration: none;
        width: 105%;
        display: block;
        padding: 4px;
        -webkit-border-radius: 8px;
        -moz-border-radius: 8px;
        border-radius: 8px;
        -webkit-box-shadow: 0px 9px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        -moz-box-shadow: 0px 9px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        box-shadow: 0px 9px 0px rgb(195, 195, 195), 0px 9px 25px rgba(0,0,0,.7);
        text-align: center;
        -webkit-transition: all .1s ease;
        -moz-transition: all .1s ease;
        -ms-transition: all .1s ease;
        -o-transition: all .1s ease;
        transition: all .1s ease;
    }

    .biscuits > .panel > .panel-body {
        width: 105%;
        text-align: center;
        color: white;
        background-color: grey;
        border-radius: 8px;
    }

    .right-inner-addon {
        position: relative;
    }

        .right-inner-addon input {
            padding-right: 30px;
        }

        .right-inner-addon i {
            position: absolute;
            right: 0px;
            padding: 10px 12px;
            pointer-events: none;
        }

    .resultPanel {
        padding: 0px;
        margin-left: 1%;
        width: 65%;
        -webkit-box-shadow: 0px 5px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        -moz-box-shadow: 0px 5px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        box-shadow: 0px 5px 0px rgb(195, 195, 195), 0px 9px 25px rgba(0,0,0,.7);
    }

    .selectedPanel {
        -webkit-box-shadow: 0px 5px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        -moz-box-shadow: 0px 5px 0px rgba(219,31,5,1), 0px 9px 25px rgba(0,0,0,.7);
        box-shadow: 0px 5px 0px rgb(195, 195, 195), 0px 9px 25px rgba(0,0,0,.7);
    }

    .header {
        background-color: white;
        background-image: none;
        background-size: auto;
        box-shadow: none;
    }

    #addMember {
        border-radius: .5em .5em .5em .5em;
    }

    /*body {
        font-family: Raleway;
    }*/

    /* end only demo styles */

    .checkbox-custom {
        opacity: 0;
        position: absolute;
    }

    .checkbox-custom, .checkbox-custom-label {
        display: inline-block;
        vertical-align: middle;
        /*margin: 5px;*/
        margin-left: 10%;
        cursor: pointer;
    }

    .checkbox-custom-label {
        position: relative;
    }

    .checkbox-custom + .checkbox-custom-label:before {
        content: '';
        /*background: #fff;*/
        /*border: 2px solid #ddd;*/
        border: 2px solid rgba(79, 75, 75, 0.8);
        display: inline-block;
        vertical-align: middle;
        width: 20px;
        height: 20px;
        /*padding: 2px;*/
        /*margin-right: 10px;*/
        text-align: center;
    }

    .checkbox-custom:checked + .checkbox-custom-label:before {
        content: "\f00c";
        font-family: 'FontAwesome';
        background: rebeccapurple;
        color: #fff;
    }

    .checkbox-custom:focus + .checkbox-custom-label {
        outline: 1px solid #ddd; /* focus style */
    }

    .select-page {
        width: 50px;
        text-align: center;
    }

    .bs-users {
        font-size: xx-small;
    }

    .tableList tr:nth-child(even) {
        background-color: rgba(100, 149, 237, 0.08);
    }
</style>
<style>
    bootstrap-select {
        outline: none !important;
        outline: 0;
    }

    .selectpicker a {
        outline: 0;
    }

    #profileImg {
        width: 50px;
        height: 50px;
        position: relative;
        display: inline-block;
        margin-top: 60px;
    }

    .imgSpan {
        position: absolute;
        top: 50%;
        min-height: 100%;
        display: block;
        left: 20%;
        -webkit-transform: translate(-50%, -50%);
        min-width: 100%;
    }
</style>

<div ng-controller="GroupEmailController as gm" id="AddGroupEmail" class="col-lg-12 zero-padding-left-right-div">
    <toaster-container toaster-options="{'time-out': 1500,
                'position-class': 'toast-top-right','close-button':true}"></toaster-container>
    <div class="col-lg-12" st-table="gm.displayed" st-pipe="gm.callServer" st-safe-src="groupMailList">
        <div class="row">
            <div class="col-lg-12" style="padding-left:0px">
                <form id="GroupMailDiv">
                    <div class="col-lg-4 form-group">
                        <label for="GroupName">Group Mail Name *</label>
                        <div id="GroupName" style="width:85%">
                            @Html.TextBoxFor(model => model.EmailGroupName, new { @class = "form-control input-sm", data_ng_model = "tempObject.EmailGroupName", data_val = "true" })
                            <span style="color:red" ng-if="grpNameErrorMessage">Please provide Group Mail Name</span>
                        </div>
                    </div>
                    <div class="col-lg-4 form-group">
                        <label for="id2">Description *</label>
                        <div id="id2">
                            <textarea class="large-compact" name="Description" ng-model="tempObject.Description" cols="30" rows="10"></textarea><br>
                            <span style="color:red" ng-if="descriptionErrorMessage">Please provide Description</span>
                        </div>
                    </div>
                    <div class="col-lg-4 form-group" ng-if="isEdit">
                        <label for="id3">Owner:</label>
                        <div id="id3">
                            <i class="data-label" style="font-size:large">{{tempObject.CreatedBy.EmailId}}</i>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="row" style="padding-left:0px">
            <div class="col-lg-12 form-group">
                <div class="col-lg-8" style="padding-left:0px">
                    <label>Search</label>
                    <div id="AddMoreData" style="margin-left:2%">
                        <div class="row">
                            <div class="col-lg-12" style="margin-left: -2.5%">
                                <div class="col-lg-12 form-group zero-padding-left-right-div">
                                    <span class="col-lg-3" style="width:30%;padding:0px;border:none">
                                        @*<select class="form-control" ng-model="dataset" ng-change="fetchData(dataset)">
                                                <option value="1">All</option>
                                                <option disabled label="Provider Level"></option>
                                                <option value="" ng-repeat="c in optionVal.ProviderLevel">{{c.Name}}</option>

                                                <option disabled>IPA</option>
                                                <option ng-repeat="ipa in optionVal.IPA">{{ipa.Group.Name}}</option>
                                            </select>*@
                                        <select class="dropdown searchselectpicker show-menu-arrow show-tick form-control" data-role="slider" data-width="100%" data-border-color="white" multiple="multiple" data-actions-box="true" data-selected-text-format="count > 2">
                                            <optgroup label="Select Providers" id="selectGroup" style="display:none;border:1px solid; background-color:white">
                                                @*<option label="Select"></option>*@
                                                @*<option>All</option>*@
                                                <option disabled>Provider Level</option>
                                                <option value="Provider Doctor">Doctor</option>
                                                <option value="Provider Mid Level">Mid Level</option>
                                                <option value="Provider Others">Others</option>
                                                <option disabled>IPA</option>
                                                <option value="IPA Access">Access</option>
                                                <option value="IPA Access2">Access2</option>
                                                <option value="IPA MIRRA">MIRRA</option>
                                                <option value="IPA ACO">ACO</option>
                                                <option disabled>Provider Relationship</option>
                                                <option value="Relationship Employee">Employee</option>
                                                <option value="Relationship Affiliate">Affiliate</option>
                                            </optgroup>

                                        </select>

                                    </span>
                                    <span class="col-lg-8"><input st-search="" ng-model="searchBox" class="form-control" ng-disabled="GlobalSearchbox" id="GlobalSearchboxid" placeholder="Global Search ..." type="text" />@*<input class="form-control input-sm" name="GlobalSearch" autocomplete="off" ng-model="search" placeholder="Global Search" style="width:116%">*@</span>
                                </div>

                                <div>

                                    @*<span class="col-lg-8"><input st-search="" class="form-control" placeholder="global search ..." type="text" /></span>
                                        <input st-search="" class="form-control" placeholder="global search ..." type="text" />*@
                                </div>

                                @*<input class="form-control input-sm" name="GlobalSearch" autocomplete="off" ng-model="search" ng-focus="searchCumDropDown()" placeholder="Search">*@
                                <div class="col-lg-offset-3">
                                    <div class="col-lg-12">
                                        <span class="col-lg-2">
                                            <button type="button" id="viewAddMember" class="btn btn-primary btn-sm" ng-click="showAddDetails()" style="padding:0.7%;margin-left:35%">Add New</button>
                                        </span>
                                        &nbsp;
                                        <span class="col-lg-11" ng-show="addNewMember">
                                            <span class="col-lg-5">Name:<span><input class="form-control input-sm" name="MemberName" autocomplete="off" ng-model="OtherPersonName" placeholder="Name"></span></span>
                                            <span class="col-lg-5">Email ID:<span><input class="form-control input-sm" name="mailId" id="otherEmailId" autocomplete="off" ng-model="OtherEmail" placeholder="Email ID"></span><p ng-if="errMsgForotherEmail" style="color:red">Invalid Email...</p></span>
                                            <span class="col-lg-2"><br /><button type="button" id="addMember" class="btn btn-primary btn-sm" ng-click="AddOtherMember()">Add</button></span>
                                        </span>

                                    </div>
                                </div>
                            </div>

                            @*<div class="col-lg-2 zero-padding-left-right-div">
                                    <i ng-click="AddMore()" class="fa fa-plus-circle fa-2x" style="margin-left:53%"></i>
                                </div>*@
                            @*<div>
                                    <i class="fa fa-plus-circle fa-3x"></i>
                                </div>*@
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 panel biscuits_3D">
                    <div class="row">
                        <div class="col-lg-12" style="padding-right:0px">
                            <div class=" col-lg-3 panel-body" style="background-color: rgba(99, 191, 228, 0.87); width: 25%;margin-left:-4%;font-size:90%">
                                <div><i class="fa fa-users fa-2x" style="font-size:155%"></i><b>&nbsp;&nbsp;{{tempObject.EmailObj.length}}</b><br /> <span style="font-size:smaller">All</span></div>
                            </div>
                            <div class=" col-lg-3 panel-body" style="background-color: rgba(51, 122, 183, 0.8); width: 25%; margin-left: 5px; font-size: 90%">
                                <div><i class="fa fa-users fa-2x" style="font-size:155%"></i><b>&nbsp;&nbsp;{{ProviderData.length}}</b><br /> <span style="font-size:smaller">Providers</span></div>
                            </div>
                            <div class=" col-lg-3 panel-body" style="background-color: rgba(92, 184, 92, 0.78); width: 24%; margin-left: 5px; font-size: 90%;">
                                <div><i class="fa fa-user fa-2x" style="font-size:155%"></i>&nbsp;&nbsp;<b>{{UsersData.length}}</b><br /><span style="font-size:smaller"> Users</span></div>
                            </div>
                            <div class=" col-lg-3 panel-body" style="background-color: rgba(124, 124, 126, 0.72); width: 24%; margin-left: 5px; font-size: 90%;">
                                <div>
                                    <i class="fa fa-user fa-2x" style="font-size:155%"></i>&nbsp;&nbsp;<b>{{otherUsersData.length}}</b><br /><span style="margin-left: -11px;margin-right: -9px;font-size:72%">Other Members</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 resultPanel" ng-hide="GlobalSearchbox">
                <div ng-cloak class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            Search Results<span class="pull-right">
                                <input id="checkboxAll" class="checkbox-custom" name="checkbox-All" type="checkbox" ng-click="selectAll(user)" />
                                @*<st-select-all all="filtered"></st-select-all>*@
                                <label for="checkboxAll" class="checkbox-custom-label" style="margin-left:-2%">&nbsp; Select All</label>
                            </span>
                        </h3>

                        @*<input type="checkbox" name="select-all" data-ng-model="selectedAll" ng-change="selectAll()" class="Sharath" id="select-all">*@
                        @*<label id="select-all" class="Sharath pull-right" for="select-all" style="padding:0.5%;width:13%;margin-top:-3%;font-size:small" data-toggle="tooltip" data-placement="top" title="Add to group">Select All</label>*@
                    </div>
                    <div class="panel-body" style="padding:0px">

                        @*<div class="col-lg-12" style="overflow-x:auto;">*@

                        <table class='table table-condensed customtbodyStyle table-striped tableList'>
                            <thead>
                                <tr>
                                    <th st-sort="NPINumber" class="col-lg-2" ng-if="AddEditColumnStatus.NPI">NPI Number</th>
                                    <th st-sort-default="reverse" st-sort="FullName" class="col-lg-2">Full Name</th>
                                    <th st-sort="EmailIds" class="col-lg-2">Email ID</th>
                                    <th st-sort="ProviderLevel" class="col-lg-2" ng-if="AddEditColumnStatus.providerLevel">Provider Level</th>
                                    @*<th st-sort="Status" class="col-lg-2">Status</th>*@
                                    <th st-sort="IPA" class="col-lg-2" ng-if="AddEditColumnStatus.IPA">IPA</th>
                                    <th st-sort="Roles" class="col-lg-1" ng-if="AddEditColumnStatus.Role">Role</th>
                                    <th st-sort="ProviderRelationship" class="col-lg-2" ng-if="AddEditColumnStatus.ProviderRelationship">Provider Relationship</th>
                                    <th class="col-lg-1">ACTION</th>
                                </tr>
                            </thead>
                            <tbody ng-show="!gm.isLoading">
                                <tr ng-repeat="c in gm.displayed track by $index">
                                    <td class="wrap-words" ng-if="AddEditColumnStatus.NPI">{{c.NPINumber || 'Not Available'}}</td>
                                    <td class="wrap-words">{{c.FullName || 'Not Available'}}</td>
                                    <td class="wrap-words">{{c.EmailIds|| 'Not Available'}}</td>
                                    <td class="wrap-words" ng-if="AddEditColumnStatus.providerLevel">{{c.ProviderLevel || 'Not Available'}}</td>
                                    <td class="wrap-words" ng-if="AddEditColumnStatus.IPA"><span ng-repeat="i in c.IPA track by $index"><span ng-if="$index>0">,</span>{{i}}</span><span ng-show="c.IPA.length<1">Not Available</span></td>
                                    @*<td>{{c.Status|| 'Not Available'}}</td>*@
                                    <td class="wrap-words" ng-if="AddEditColumnStatus.Role"><span ng-repeat="r in c.Roles track by $index"><span ng-if="$index>0">,</span>{{r}}</span><span ng-show="c.UserType=='User' && c.Roles.length==0">Not Available</span><span ng-show="c.UserType=='OtherUser'">NA</span></td>
                                    <td class="wrap-words" ng-if="AddEditColumnStatus.ProviderRelationship">{{c.ProviderRelationship|| 'Not Available'}}</td>
                                    <td>
                                        <input id="checkbox1{{$index}}" class="checkbox-custom" name="checkbox-2" ng-model="c.isChecked" type="checkbox" ng-click="pushEmail(c)" />
                                        <label for="checkbox1{{$index}}" class="checkbox-custom-label"></label>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody ng-show="gm.isLoading">
                                <tr>
                                    <td colspan="8" class="text-center">
                                        <div class="loading-indicator"></div>
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot style="cursor:pointer">
                                <tr ng-if="groupMailList.length>10">
                                    <td class="text-center" st-pagination="" st-items-by-page="10" colspan="8"></td>
                                </tr>
                            </tfoot>
                        </table>
                        @*</div>*@
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4" ng-show="selectedUsersGrid || editgrid">
                <div ng-cloak class="panel panel-primary selectedPanel">
                    <div class="panel-heading">
                        <h5 class="panel-title">Selected Members</h5>
                        &nbsp;
                    </div>
                    <div class="panel-body">
                        <div class="col-lg-12" style="margin-bottom:2%;margin-top:-2%">
                            <button type="button" ng-show="tempObject.EmailObj.length>0" id="all" class="btn btn-sm" ng-click="viewSpecificData('All')" style="padding: 0.6%; border-radius: 0.5em 0.5em 0.5em 0.53em; margin-left: -7%; font-size: x-small; background-color: rgba(99, 191, 228, 0.87); "><i style="font-size: large" class="fa fa-users fa-1x"></i>All</button>
                            <button type="button" ng-show="ProviderData.length>0" id="provider" class="btn btn-sm" ng-click="viewSpecificData('Provider')" style="padding: 0.6%; border-radius: 0.5em 0.5em 0.5em 0.53em; font-size: x-small; background-color: rgba(51, 122, 183, 0.68); "><i style="font-size: large" class="fa fa-users fa-1x"></i>Providers</button>
                            <button type="button" ng-show="UsersData.length>0" id="users" class="btn btn-sm" ng-click="viewSpecificData('Users')" style="padding: 0.6%; border-radius: 0.5em 0.5em 0.5em 0.53em; font-size: x-small; background-color: rgba(92, 184, 92, 0.71); "><i style="font-size: large" class="fa fa-user fa-1x"></i>Users</button>
                            <button type="button" ng-show="otherUsersData.length>0" id="otherMembers" class="btn btn-sm" ng-click="viewSpecificData('Others')" style="padding: 0.6%; border-radius: 0.5em 0.5em 0.5em 0.53em; font-size: xx-small; background-color: rgba(124, 124, 126, 0.63); "><i style="font-size: large" class="fa fa-user fa-1x"></i>Other Members</button>
                        </div>

                        <div class="col-lg-12" style="border-bottom: 1px solid; border-bottom-color: darkblue; max-height: 450px; overflow-y: scroll; overflow: auto">
                            <div class="col-lg-12" ng-repeat="data in filteredtempdata = (tempSelectedObject.EmailObj | filter:AddedEmailId) track by $index">
                                @*<div class="col-lg-1" style="margin-top:18%;padding-left:0px">
                                <input id="checkbox3{{$index}}" class="checkbox-custom" name="checkbox-3" ng-model="data.isChecked" type="checkbox" ng-click="removeSelected(data)" />
                                <label for="checkbox3{{$index}}" class="checkbox-custom-label"></label>
                            </div>*@
                                <div class="col-lg-2">
                                    <span ng-if="data.ProfileImagePath!=null" class="imgSpan"><img id="profileImg" ng-src="@System.Configuration.ConfigurationManager.AppSettings["AppRoot"]/Document/View?path=@System.Configuration.ConfigurationManager.AppSettings["AppRoot"]{{data.ProfileImagePath}}" alt="Document" class="mg-thumbnail" /></span><span ng-if="data.ProfileImagePath==null" class="imgSpan"><img id="profileImg" ng-src="@System.Configuration.ConfigurationManager.AppSettings["AppRoot"]/Document/View?path=@System.Configuration.ConfigurationManager.AppSettings["AppRoot"] /Content/Images/a0.jpg" alt="Document" class="mg-thumbnail" /></span>
                                </div>
                                <div class="col-lg-10">
                                    <span ng-if="SelectedMembersColumnStatus.NPI"> NPI : <span class="wrap-words">{{data.NPINumber||'Not Available'}}</span><br /></span>
                                    <span>Name : <span class="wrap-words">{{data.FullName||'Not Available'}}</span><br /></span>
                                    <span>Email Id : <span class="wrap-words">{{data.EmailIds||'Not Available'}}</span><br /></span>
                                    <span ng-if="SelectedMembersColumnStatus.Role">Role :<span ng-repeat="r in data.Roles" class="wrap-words"><span ng-if="$index>0">,</span>{{r}}</span></span>
                                    <span ng-if="SelectedMembersColumnStatus.providerLevel">Provilder Level : <span class="wrap-words">{{data.ProviderLevel||'Not Available'}}</span><br /></span>
                                    <span ng-if="SelectedMembersColumnStatus.IPA">IPA : <span class="wrap-words"><span ng-repeat="i in data.IPA"><span ng-if="$index>0">,</span>{{i}}</span></span><br /></span>
                                </div>
                                <div class="col-lg-1" style="margin-left:97%">
                                    <span class="pull-right" style="font-size:x-large;cursor:pointer"><i class="fa fa-trash-o" aria-hidden="true" ng-click="removeSelected(data)" data-toggle="tooltip" data-placement="left" title="Remove"></i></span>
                                    @*<i class="fa fa-trash-o" aria-hidden="true"></i>*@
                                </div>
                                <hr style="width:100%" />

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <br />
        <div class="row">
            <div class="col-lg-12">
                <button class="btn btn-warning" ng-click="CancelAddView()">Cancel</button>
                <button ng-if="!isView && !TableView && !isEdit" class="btn btn-primary pull-right" ng-click="saveGroup()">Save Group</button>
                <button ng-if="isEdit" class="btn btn-primary pull-right" ng-click="UpdateGroup()">Update Group</button>
            </div>
        </div>
    </div>
    <div class="modal fade" id="otherMemberWarningModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Warning!!!!</h4>
                </div>
                <div class="modal-body" ng-show="!isRemoved">
                    An other member with this Email Id already exists. Do you still want to add?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" ng-click="AddMember()" data-dismiss="modal">Add</button>
                </div>
            </div>
        </div>
    </div>
</div>
@model AHC.CD.WebUI.MVC.Models.TaskTracker.TaskTrackerViewModel
<style>
    .table {
        width: 100%;
        max-width: 100%;
        margin-bottom: 0px;
    }

    .input-validation-error {
        border: 1px solid silver !important;
    }

    /*.borderless tbody tr td, .borderless tbody tr th, .borderless thead tr th {
        font-size: smaller;
        border: none;
    }*/
    .borderless tbody tr td, .borderless tbody tr th {
        font-size: smaller;
        border: none;
    }

    .Width {
        width: 97.5%;
    }

    .notesTable tr:nth-child(even) {
        background-color: rgba(100, 149, 237, 0.08);
    }

    .notesTable thead {
        color: white;
        background-color: rgba(100, 149, 237, 0.78);
    }

    .notesTable tr:hover {
        background-color: rgba(100, 149, 237, 0.05);
    }

    #followUp {
        background-color: white;
        cursor: default;
    }
</style>
<form id="newTaskFormDiv" name="newTaskFormDiv">
    <div>
        <div>
            <div class="col-lg-12 zero-padding-left-right-div">
                <span ng-if="task.TaskTrackerId">
                    <input type="hidden" name="TaskTrackerId" ng-model="task.TaskTrackerId" value="{{task.TaskTrackerId}}" />
                </span>
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Provider *</label>
                    <input type="hidden" name="ProfileID" data-val="true" data-val-required="Please select the Provider Name" value="{{task.ProfileID}}" />
                    <input class="form-control input-sm" name="ProviderName" autocomplete="off" ng-model="task.ProviderName" ng-focus="searchCumDropDown('ProviderList')" />
                    @*<span ng-if="Providers.length == 0" class="text-danger field-validation-error">
                            <span>Please select the Provider.</span>
                        </span>*@
                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" id="ProviderList">
                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">
                            <tbody>
                                <tr ng-repeat="provider in filteredProvidersResults = (Providers | filter:task.ProviderName)" ng-click="SelectProvider(provider)" class="pointer">
                                    <td>{{provider.Name}}</td>
                                </tr>
                                <tr ng-if="Providers.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="Providers.length > 0 && filteredProvidersResults.length == 0">
                                    <td>Provider not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    @*<span ng-show="newTaskFormDiv.ProviderName.$dirty && newTaskFormDiv.ProviderName.$error.required">
                            <span class="error text-danger" ng-show="newTaskFormDiv.ProviderName.$error.required">Please select the Provider.</span>
                        </span>*@
                    <span ng-show="errormessageforprovider" class="text-danger">Please Select Provider Name</span>
                    @*@Html.ValidationMessageFor(model => model.ProfileID, "", new { @class = "text-danger" })*@
                </div>
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Sub Section *</label>
                    <input type="hidden" data-val="true" data-val-required="Please select the Sub Section Name" name="SubSectionName" value="{{task.SubSectionName}}" />
                    <input class="form-control input-sm" name="SubSectionName" autocomplete="off" ng-model="task.SubSectionName" ng-focus="searchCumDropDown('SubSectionList')" placeholder="Select Sub Section" />
                    @*<span ng-if="SubSections.length == 0" class="text-danger field-validation-error">
                            <span>Please select the sub section.</span>
                        </span>*@
                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" id="SubSectionList">
                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">
                            <tbody>
                                <tr ng-repeat="subSection in filteredSubSectionsResults = (SubSections | filter:task.SubSectionName)" ng-click="SelectSubSection(subSection)" class="pointer">
                                    <td>{{subSection.SubSectionName}}</td>
                                </tr>
                                <tr ng-if="SubSections.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="SubSections.length > 0 && filteredSubSectionsResults.length == 0">
                                    <td>Sub Section not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    @*<span ng-show="newTaskFormDiv.SubSectionName.$dirty && newTaskFormDiv.SubSectionName.$invalid">
                            <span class="error text-danger" ng-show="newTaskFormDiv.SubSectionName.$error.required">Please select the Sub Section.</span>
                        </span>*@
                    <span ng-show="errormessageforsubsection" class="text-danger">Please Select Sub Section</span>
                    @*@Html.ValidationMessageFor(model => model.SubSectionName, "", new { @class = "text-danger" })*@
                </div>
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Subject *</label>
                    @*<input type="text" name="Subject" ng-model="task.Subject" class="form-control input-sm" />*@
                    @Html.TextBoxFor(model => model.Subject, new { @class = "form-control input-sm", data_ng_model = "task.Subject" })
                    @Html.ValidationMessageFor(model => model.Subject, "", new { @class = "text-danger" })
                    @*<span ng-show="errormessageforsubject" class="text-danger">Please enter Subject</span>*@
                </div>
            </div>
            <div class="col-lg-12 zero-padding-left-right-div">
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Next Followup *</label>
                    @*<input id="followUp" type="text" @*readonly="readonly" ng-focus="searchCumDropDown()" autocomplete="off" data-date-format="MM/dd/yyyy" ng-class="{'input-validation-error':NextFollowUpDate>=Today()}" data-bs-datepicker="bs-datepicker" data-val="true" data-val-required="Please select the Next Followup date" ng-model="task.NextFollowUpDate" name="NextFollowUpDate" class="form-control input-sm" />*@
                    @Html.TextBoxFor(model => model.NextFollowUpDate, new { @class = "form-control input-sm", placeholder = "mm/dd/yyyy", data_val_date = "Please enter date in mm/dd/yyyy format", data_ng_model = "task.NextFollowUpDate", data_date_format = "MM/dd/yyyy", data_bs_datepicker = "bs-datepicker", data_ng_click = "closenotesDiv()" })
                    @Html.ValidationMessageFor(model => model.NextFollowUpDate, "", new { @class = "text-danger" })
                    @*<span ng-show="errormessageforfollowupdate" class="text-danger">Please enter next Followup Date</span>*@
                </div>
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Mode Of Followup *</label>
                    <input type="hidden" name="ModeOfFollowUp" data-val="true" ng-value="Tempfollowup1" />
                    <input class="form-control input-sm" name="FollowUpMode" autocomplete="off" ng-model="task.FollowUp" ng-focus="searchCumDropDown('FollowupList')" placeholder="Select Mode Of Followup" />

                    @*<span ng-if="Followups.length == 0" class="text-danger field-validation-error">
                            <span>Please select the follow up.</span>
                        </span>*@
                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" id="FollowupList">
                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">
                            <tbody>
                                <tr ng-repeat="followup in filteredFollowupsResults = (Followups | filter:task.FollowUp) track by $index" ng-click="SelectFollowup(followup)" class="pointer">
                                    <td>{{followup.Name}}</td>
                                </tr>
                                <tr ng-if="Followups.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="Followups.length > 0 && filteredFollowupsResults.length == 0">
                                    <td>Mode of follow up not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <span ng-repeat="taskselected in Tempfollowup">
                        <span class="label label-provider-type">
                            {{taskselected.Name}}
                            <i class="fa fa-close pointer" ng-click="RemoveFollowup(taskselected)"></i>
                        </span>
                    </span>
                    <span ng-show="errormessage" class="text-danger">Please Select the Mode of Followup</span>
                    @*<span ng-show="newTaskFormDiv.FollowUpMode.$dirty && newTaskFormDiv.FollowUpMode.$invalid">
                            <span class="error text-danger" ng-show="newTaskFormDiv.FollowUpMode.$error.required">Please select the FollowUp Mode.</span>
                        </span>*@
                    @*@Html.ValidationMessageFor(model => model.ModeOfFollowUp, "", new { @class = "text-danger" })*@
                </div>
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Assign To *</label>
                    <input type="hidden" name="AssignedToAuthId" data-val="true" data-val-required="Please select the Assign To User" value="{{task.AssignedToId}}" />
                    <input class="form-control input-sm" name="AssignedTo" autocomplete="off" ng-model="task.AssignedTo" ng-focus="searchCumDropDown('UserList')" placeholder="Select User" />
                    @*<span ng-if="users.length == 0" class="text-danger field-validation-error">
                            <span>Please select the User.</span>
                        </span>*@
                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" id="UserList">
                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">
                            <tbody>
                                <tr ng-repeat="user in filteredUsersResults = (users | filter:task.AssignedTo)" ng-click="SelectUser(user)" class="pointer">
                                    <td>{{user.FullName}}-{{user.UserName}}</td>
                                </tr>
                                <tr ng-if="users.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="users.length > 0 && filteredUsersResults.length == 0">
                                    <td>User not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    @*@Html.ValidationMessageFor(model => model.AssignedToAuthId, "", new { @class = "text-danger" })*@
                    <span ng-show="errormessageforAssignedto" class="text-danger">Please select the Assign To User</span>
                    @*<span ng-show="newTaskFormDiv.AssignedTo.$dirty && newTaskFormDiv.AssignedTo.$invalid"><span class="error text-danger" ng-show="newTaskFormDiv.AssignedTo.$error.required">Please select the User.</span></span>*@
                </div>
            </div>
            <div class="col-lg-12 zero-padding-left-right-div">
                <div class="col-lg-4 form-group">
                    <label class="control-label small">Hospital</label>
                    <input type="hidden" name="HospitalID" value="{{task.HospitalID}}" />
                    <input class="form-control input-sm" name="HospitalName" autocomplete="off" ng-model="task.Hospital" ng-blur="hideHospitalSearchDiv=true" ng-focus="hideHospitalSearchDiv=false;searchCumDropDown('HospitalList')" placeholder="Select Hospital" />
                    @*<span ng-if="Hospitals.length == 0" class="text-danger field-validation-error">
                            <span>Please select the Hospital.</span>
                        </span>*@
                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" ng-hide="hideHospitalSearchDiv" id="HospitalList">
                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">
                            <tbody>
                                <tr ng-repeat="hospital in filteredHospitalsResults = (Hospitals | filter:task.Hospital)" ng-click="SelectHospital(hospital)" class="pointer">
                                    <td>{{hospital.HospitalName}}</td>
                                </tr>
                                <tr ng-if="Hospitals.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="Hospitals.length > 0 && filteredHospitalsResults.length == 0">
                                    <td>Hospital not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <span ng-show="errormessageforHospitalName" class="text-danger">Please select a valid Hospital Name</span>
                </div>

                @*Manideep*@

                <div class="col-lg-4 form-group">
                    <label class="control-label small">Plan Name</label>
                    <input type="hidden" name="PlanName" value="{{task.PlanName}}" />
                    <input class="form-control input-sm" name="PlanName" autocomplete="off" ng-model="task.PlanName" ng-focus="searchCumDropDown('InsuranceList')" placeholder="Select Plan Name" />

                    <div class="ProviderTypeSelectAutoList popover fade bottom in" role="tooltip" id="InsuranceList">

                        <table class="table table-striped table-bordered table-hover table-condensed" style="margin-bottom: 0px;">

                            <tbody>

                                <tr ng-repeat="insurance in filteredInsuranceResults = (PlanNames | filter:task.PlanName)" ng-click="SelectInsurance(insurance)" class="pointer">

                                    <td>{{insurance.PlanName}}</td>
                                </tr>
                                <tr ng-if="PlanNames.length == 0">
                                    <td>No data..... </td>
                                </tr>
                                <tr ng-if="PlanNames.length > 0 && filteredInsuranceResults.length == 0">
                                    <td>Name not found..... </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <span ng-show="errormessageforInsurancecompany" class="text-danger">Please select a valid Insurance Company Name</span>
                </div>



            </div>

            <div class="col-lg-12 zero-padding-left-right-div">
                <div class="col-lg-12 form-group">
                    <label class="control-label small">Notes</label>
                    @*<textarea ng-model="task.Notes" name="Notes" class="form-control input-sm"></textarea>*@
                    @*@Html.TextAreaFor(model => model.Notes, new { @class = "form-control input-sm hideDropDown", data_ng_model = "task.Notes", data_ng_click = "hideDropDown();" })
                        @Html.ValidationMessageFor(model => model.Notes, "", new { @class = "text-danger" })*@
                    @*<textarea ng-if="!notetask" style="border-bottom:none;background-color:white" disabled id="prefill" class="form-control input-sm hideDropDown" ng-model="temp" cols="5" ng-click="hideDropDown()"></textarea>*@
                    @*<input type="text" class="form-control input-sm" ng-model="temp" style="overflow-x:auto" />*@
                    @*<div ng-show="visible=='add'" style="height:30px">
                            <table class="table table-bordered borderless" style="margin-bottom: 0px;">
                                <tr ng-repeat="a in temp track by $index"><td><span class="label-provider-type">{{a}}</span></td></tr>
                                <tr ><td><span class="label-provider-type">{{TempNotes}}</span></td></tr>

                            </table>
                        </div>*@
                    @*<div ng-show="visible=='edit'" id="outeritem" style="overflow-y:scroll;overflow:auto;height:50px">
                            <table class="table table-bordered borderless" style="margin-bottom: 0px;">
                                <tr id="anchor{{a.number}}" ng-repeat="a in temp track by $index"><td><span class="label-provider-type">{{a.stamp}}</span></td></tr>
                            </table>
                        </div>*@

                    <div class="clearfix"></div>
                    @*<textarea class="form-control input-sm" id="someitem"></textarea>*@
                    @*<textarea ng-if="notetask" style="background-color:white" name="Notes" class="form-control input-sm hideDropDown" ng-model="task.Notes" ng-click="hideDropDown()"></textarea>*@
                    <input type="hidden" name="Notes" value="{{TempNotes}} {{task.Notes}}">
                    <textarea id="textareaappend" style="border-bottom:none;background-color:white" name="Notes" class="form-control input-sm hideDropDown" elastic ng-blur="hidenotesdiv=true" ng-model="task.Notes" ng-focus="hidenotesdiv=false;searchCumDropDown('ForNotes');"></textarea>
                    <div class="ProviderTypeSelectAutoList popover fade bottom in Width" role="tooltip" id="ForNotes" style="margin-top: 6.5%;" ng-hide="(task.Notes.length > 0 && filterNotesData.length==0) || hidenotesdiv">
                        <table class="table table-striped table-bordered table-hover table-condensed">
                            <tbody>
                                <tr ng-repeat="temp in filterNotesData=(NotesTemplates|filter:task.Notes) track by $index" ng-click="addIntoNotesTextBox(temp.Description,'ForNotes')" class="pointer">
                                    <td>{{temp.Code}}-{{temp.Description}}</td>

                                </tr>

                                @*<tr ng-if="!filterNotesData.length">
                                    <td>Notes Template Not Found</td>
                                </tr>*@
                                <tr ng-if="NotesTemplates.length==0 ">
                                    <td>No  Data  Found</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="height:30px">
                        <table class="table table-bordered borderless" style="margin-top: 0px;">
                            @*<tr ng-repeat="a in temp track by $index"><td><span class="label-provider-type">{{a}}</span></td></tr>*@
                            <tr><td><span class="label-provider-type">{{TempNotes}}</span></td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div>
                <br />
                &nbsp;
            </div>

            <div class="col-lg-12 zero-padding-left-right-div">

                @*@if (HttpContext.Current.User.Identity.IsAuthenticated)
                    {
                        var roles = Context.GetOwinContext().GetUserManager<AHC.CD.WebUI.MVC.ApplicationUserManager>().GetRoles(User.Identity.GetUserId());
                        if (roles != null)
                        {
                            if (!roles.Contains("ADM"))
                            {
                                <div id="addButton" class="legend2 pull-right">
                                    <button ng-click="showAddView()" class="btn btn-xs btn-primary" tooltip data-toggle="tooltip" data-placement="top" title="Add New"><i class="fa fa-plus"></i></button>
                                </div>
                            }
                        }
                    }*@
                <div class="col-md-12 form-group">
                    <button type="button" ng-if="addView" class="btn btn-warning btn-sm" ng-click="cancelAdd()">Cancel</button>
                    <button type="submit" ng-if="addView" class="btn btn-primary btn-sm pull-right" ng-click="addNewTask(task)">Add</button>
                    <button type="button" ng-if="!addView" class="btn btn-warning btn-sm" ng-click="cancelEditViewforTab1()">Cancel</button>

                    <span><button type="submit" ng-if="VisibilityControl == 'editViewforTab3'|| VisibilityControl == 'editViewforTab2'|| VisibilityControl == 'editViewforTab'" class="btn btn-primary btn-sm pull-right" ng-click="editTask();">Update</button></span>
                    <span></span>
                    @*<span><button type="button" ng-if="VisibilityControl == 'editViewforTab1'" class="btn btn-primary btn-sm " ng-click="inactiveWarning(task)">Close Task</button></span>*@
                    @*<button type="button" ng-if="VisibilityControl == 'editViewforTab3'" class="btn btn-warning btn-sm" ng-click="cancelEditViewforTab1()">Cancel</button>*@

                    @*<span><button type="submit" ng-if="VisibilityControl == 'editViewforTab3' || VisibilityControl == 'editViewforTab1' " class="btn btn-primary btn-sm pull-right" ng-click="editTask()">Update</button></span>*@
                    <span></span>
                    <span><button type="submit" ng-if="VisibilityControl == 'editViewforTab3'|| VisibilityControl == 'editViewforTab2'|| VisibilityControl == 'editViewforTab'" class="btn btn-primary btn-sm " ng-click="inactiveWarning(task)">Save and Close Task</button></span>

                </div>
            </div>
            <div ng-show="visible=='edit'" class="col-lg-12 zero-padding-left-right-div" id="Notes">
                <div class="col-lg-12">
                    <table class="table table-bordered table-condensed table-hover notesTable" id="notesTable">
                        <thead style="background-color:cornflowerblue">
                            <tr>
                                @*<th>Note Type</th>*@
                                <th>Date Time</th>
                                <th>User Name</th>
                                @*<th>Subject</th>*@
                                <th>Note</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr ng-repeat="note in temp1 track by $index" class="pointer" @*title="Click to view note details"*@ @*ng-mouseover="initPop();"*@>
                                @*<td>{{'History'}}</td>*@
                                <td>{{note.modifiedDate}}</td>
                                <td>{{note.By||"-"}}</td>
                                @*<td>{{note.Subject||"-"}}</td>*@
                                @*<td class="wrap-words wraptext">{{(note.stamp| limitTo : 15)||''}}&nbsp;<a class="btn btn-link btnPadding wrap-words" title="Note" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content="{{(note.stamp| limitTo : 300)||'-'}}<b>{{note.stamp.length > 300 ? '.....' : ''}}</b>" ng-mouseover="initPop();"><b>...</b></a></td>*@
                                <td class="wrap-words">{{note.stamp}}</td>
                            </tr>

                        </tbody>

                    </table>
                </div>
            </div>
            <div>
                <br />
                &nbsp;
            </div>

            @*<div class="col-lg-12 zero-padding-left-right-div">
                <div class="col-md-12 form-group">
                    <button type="button" ng-if="addView" class="btn btn-warning btn-sm" ng-click="cancelAdd()">Cancel</button>
                    <button type="submit" ng-if="addView" class="btn btn-primary btn-sm pull-right" ng-click="addNewTask(task)">Add</button>
                    <button type="button" ng-if="!addView" class="btn btn-warning btn-sm" ng-click="cancelEditViewforTab1()">Cancel</button>
                    <span><button type="submit" ng-if="VisibilityControl == 'editViewforTab3'|| VisibilityControl == 'editViewforTab2'|| VisibilityControl == 'editViewforTab'" class="btn btn-primary btn-sm pull-right" ng-click="editTask()">Update</button></span>
                    <span></span>
                    @*<span><button type="button" ng-if="VisibilityControl == 'editViewforTab1'" class="btn btn-primary btn-sm " ng-click="inactiveWarning(task)">Close Task</button></span>*@
            @*<button type="button" ng-if="VisibilityControl == 'editViewforTab3'" class="btn btn-warning btn-sm" ng-click="cancelEditViewforTab1()">Cancel</button>*@

            @*<span><button type="submit" ng-if="VisibilityControl == 'editViewforTab3' || VisibilityControl == 'editViewforTab1' " class="btn btn-primary btn-sm pull-right" ng-click="editTask()">Update</button></span>*@
            @*<span></span>
                        <span><button type="button" ng-if="VisibilityControl == 'editViewforTab3'|| VisibilityControl == 'editViewforTab2'|| VisibilityControl == 'editViewforTab'" class="btn btn-primary btn-sm " ng-click="inactiveWarning(task)">Save and Close Task</button></span>

                    </div>
                </div>*@

        </div>
        @*<div class="col-lg-12 zero-padding-left-right-div">
                <div ng-show="activeMessageDiv=='successfullySaved'" class="alert alert-success" role="alert">
                    <button ng-click="closeAlertMessage('')" class="close"><span>&times;</span></button>
                    {{messageDesc}}
                </div>
                <div ng-show="activeMessageDiv=='errorInitiated'" class="col-lg-12">
                    <div class="alert alert-danger" role="alert">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        <span class="sr-only">Error:</span>
                        <span>{{messageDesc}}</span>
                    </div>
                </div>
            </div>*@
        @*<div class="col-lg-12 zero-padding-left-right-div">
            @*<div ng-show="activeMessageDiv=='successfullySaved'" class="alert alert-success" role="alert">
                <button ng-click="closeAlertMessage('')" class="close"><span></span></button>
            </div>*@
        @*<div ng-show="activeMessageDiv=='errorInitiated'" class="col-lg-12">
                <div class="alert alert-danger" role="alert">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    <span class="sr-only"></span>
                    <span></span>
                </div>
            </div>*@
        @*</div>*@
    </div>
</form>